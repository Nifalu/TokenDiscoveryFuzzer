# Extractor: 'corpus' or 'mutation_delta'
# The method used to 'extract' the initial pipeline input.
extractor:
  type: corpus

# Pipeline: processors run in order
# Processors modify or filter the input
# sais: pattern matching based on sa-is algorithm
# filter_null_bytes: removes inputs with too many null bytes
# strip_bytes: removes specified bytes at the start/end of input
# remove_substrings: removes substrings within the input
pipeline:
  - type: sais
    min_len: 3
    max_len: 64
    threshold: 0.015

  - type: filter_null_bytes
    max_ratio: 0.4

  - type: strip_bytes
    bytes: [0x00, 0x0A, 0x0D, 0x20]  # null, LF, CR, ' ',
    min_length: 3 # minimum length after stripping

  - type: remove_similar
    threshold: 0.7
    keep_longer: true

  - type: remove_repetitive
    threshold: 0.6

  #- type: remove_substrings

# Token discovery settings
min_corpus_size: 500
search_interval: 2000
max_tokens: 2500
max_token_length: 64
min_token_length: 4
search_pool_size: 2500
displayed_tokens: 30

# Fuzzer settings
fuzzer_preset: preserving_tokens
scheduler_preset: fast
timeout_secs: 8
fuzz_loop_for: 1000000

# Paths
corpus_dir: "./corpus"
crashes_dir: "./crashes"
